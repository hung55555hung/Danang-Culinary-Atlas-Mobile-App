### React Native Configuration

#### 1. Cài đặt Deep Link Package

```bash
npm install react-native-deep-linking
# hoặc
yarn add react-native-deep-linking
```

#### 2. Android Setup (`android/app/src/main/AndroidManifest.xml`)

```xml
<activity
  android:name=".MainActivity"
  android:launchMode="singleTask">
  
  <intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />
    <data android:scheme="atlasculinary" />
  </intent-filter>
</activity>
```

#### 3. iOS Setup (`ios/YourApp/Info.plist`)

```xml
<key>CFBundleURLTypes</key>
<array>
  <dict>
    <key>CFBundleURLSchemes</key>
    <array>
      <string>atlasculinary</string>
    </array>
  </dict>
</array>
```

#### 4. React Native Code

```javascript
import { Linking } from 'react-native';
import { useEffect, useState } from 'react';
import { useNavigation } from '@react-navigation/native';

// API Service
import axios from 'axios';

const API_BASE_URL = 'https://api.atlasculinary.com';

export const authAPI = {
  forgotPassword: async (email) => {
    const response = await axios.post(`${API_BASE_URL}/api/v1/auth/forgot-password`, {
      email,
      platform: 'mobile'
    });
    return response.data;
  },
  
  validateResetToken: async (token) => {
    const response = await axios.get(
      `${API_BASE_URL}/api/v1/auth/validate-reset-token?token=${token}`
    );
    return response.data;
  },
  
  resetPassword: async (token, newPassword, confirmPassword) => {
    const response = await axios.post(`${API_BASE_URL}/api/v1/auth/reset-password`, {
      token,
      newPassword,
      confirmPassword
    });
    return response.data;
  }
};

// Screen: ForgotPasswordScreen.js
export const ForgotPasswordScreen = () => {
  const [email, setEmail] = useState('');
  const [loading, setLoading] = useState(false);
  
  const handleForgotPassword = async () => {
    try {
      setLoading(true);
      const response = await authAPI.forgotPassword(email);
      
      if (response.success) {
        Alert.alert(
          'Thành công',
          'Đã gửi email hướng dẫn đặt lại mật khẩu. Vui lòng kiểm tra hộp thư của bạn.',
          [{ text: 'OK' }]
        );
      }
    } catch (error) {
      Alert.alert('Lỗi', error.response?.data?.message || 'Có lỗi xảy ra');
    } finally {
      setLoading(false);
    }
  };
  
  return (
    <View style={styles.container}>
      <TextInput
        placeholder="Email"
        value={email}
        onChangeText={setEmail}
        keyboardType="email-address"
        autoCapitalize="none"
      />
      <Button 
        title={loading ? "Đang gửi..." : "Gửi Email Reset"}
        onPress={handleForgotPassword}
        disabled={loading}
      />
    </View>
  );
};

// Screen: ResetPasswordScreen.js
export const ResetPasswordScreen = ({ route }) => {
  const navigation = useNavigation();
  const [token, setToken] = useState(route.params?.token || '');
  const [newPassword, setNewPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [tokenValid, setTokenValid] = useState(false);
  
  useEffect(() => {
    // Validate token khi screen load
    validateToken();
  }, [token]);
  
  const validateToken = async () => {
    try {
      setLoading(true);
      const response = await authAPI.validateResetToken(token);
      
      if (response.success) {
        setTokenValid(true);
      } else {
        Alert.alert('Lỗi', 'Token không hợp lệ hoặc đã hết hạn');
        setTokenValid(false);
      }
    } catch (error) {
      Alert.alert('Lỗi', 'Không thể xác thực token');
      setTokenValid(false);
    } finally {
      setLoading(false);
    }
  };
  
  const handleResetPassword = async () => {
    if (newPassword !== confirmPassword) {
      Alert.alert('Lỗi', 'Mật khẩu xác nhận không khớp');
      return;
    }
    
    if (newPassword.length < 6) {
      Alert.alert('Lỗi', 'Mật khẩu phải có ít nhất 6 ký tự');
      return;
    }
    
    try {
      setLoading(true);
      const response = await authAPI.resetPassword(token, newPassword, confirmPassword);
      
      if (response.success) {
        Alert.alert(
          'Thành công',
          'Đặt lại mật khẩu thành công. Vui lòng đăng nhập lại.',
          [
            {
              text: 'OK',
              onPress: () => navigation.navigate('Login')
            }
          ]
        );
      }
    } catch (error) {
      Alert.alert('Lỗi', error.response?.data?.message || 'Có lỗi xảy ra');
    } finally {
      setLoading(false);
    }
  };
  
  if (loading) {
    return <ActivityIndicator size="large" />;
  }
  
  if (!tokenValid) {
    return (
      <View style={styles.container}>
        <Text>Token không hợp lệ hoặc đã hết hạn</Text>
        <Button title="Quay lại" onPress={() => navigation.goBack()} />
      </View>
    );
  }
  
  return (
    <View style={styles.container}>
      <TextInput
        placeholder="Mật khẩu mới"
        value={newPassword}
        onChangeText={setNewPassword}
        secureTextEntry
      />
      <TextInput
        placeholder="Xác nhận mật khẩu"
        value={confirmPassword}
        onChangeText={setConfirmPassword}
        secureTextEntry
      />
      <Button
        title={loading ? "Đang xử lý..." : "Đặt lại mật khẩu"}
        onPress={handleResetPassword}
        disabled={loading}
      />
    </View>
  );
};

// App.js - Deep Link Handler
const App = () => {
  const navigationRef = useRef();
  
  useEffect(() => {
    // Xử lý deep link khi app đang chạy
    const handleDeepLink = ({ url }) => {
      const route = parseDeepLink(url);
      if (route) {
        navigationRef.current?.navigate(route.screen, route.params);
      }
    };
    
    // Subscribe to deep link events
    const subscription = Linking.addEventListener('url', handleDeepLink);
    
    // Xử lý deep link khi mở app từ killed state
    Linking.getInitialURL().then(url => {
      if (url) {
        handleDeepLink({ url });
      }
    });
    
    return () => subscription.remove();
  }, []);
  
  const parseDeepLink = (url) => {
    // URL format: atlasculinary://reset-password?token=xxx
    if (!url) return null;
    
    const regex = /atlasculinary:\/\/reset-password\?token=(.+)/;
    const match = url.match(regex);
    
    if (match && match[1]) {
      return {
        screen: 'ResetPassword',
        params: { token: match[1] }
      };
    }
    
    return null;
  };
  
  return (
    <NavigationContainer ref={navigationRef}>
      {/* Your navigation setup */}
    </NavigationContainer>
  );
};